<div ng-include="'components/navbar/navbar.html'"></div>
<div class="container">
    <div class="row">
        <div class="col-xs-8">
            <ol class="breadcrumb">
                <li><a ui-sref="topicsList">Topics</a></li>
                <li><a ui-sref="topic({topicId:QuotesCtrl.topic._id})">{{QuotesCtrl.topic.title}}</a></li>
                <li class="active">Inspiration Page</li>
            </ol>
        </div>
        <div class="col-xs-4" ng-if="!QuotesCtrl.topic.isDefault">
            <a id="addQuote" class="btn btn-info btn-block" ng-click="QuotesCtrl.openQuoteModal('lg')">
                <span class="glyphicon glyphicon-plus"></span> Add Quote
            </a>
        </div>
    </div>
    <div class="row searchQuotes">
        <div class="col-lg-6">
            <input type="text" class="form-control" required ng-keypress="vm.typeAhead" ng-model="vm.typeAhead" placeholder="search in quotes">
        </div>
        <div class="col-lg-6"> Group by
            <button class="btn btn-default" ng-click="vm.groupBy=true; vm.groupBy='source'" ng-class="{'activeGroup':vm.groupBy==='source'}">Source</button>
            <button class="btn btn-default" ng-click="vm.groupBy=true; vm.groupBy='author'" ng-class="{'activeGroup':vm.groupBy==='author'}">Author</button>
            <button class="btn btn-default" ng-click="vm.groupBy=true; vm.groupBy='theDay'" ng-class="{'activeGroup':vm.groupBy==='theDay'}">Date</button>
            <button class="btn btn-default" ng-click="vm.groupBy=false" ng-class="{'activeGroup':vm.groupBy===false}">None</button>
        </div>
    </div>
    <br>
    <div class="container" id="quotes" ng-if="vm.groupBy">
        <div bindonce ng-repeat="group in QuotesCtrl.quotes | groupBy:vm.groupBy 
            | toArray:true
            | orderBy:[(vm.groupBy!=='theDay')?'$key':'date']:(vm.groupBy==='theDay')?true:false
            | filter:vm.typeAhead ">
            <div class="group">
                <hr>
                <strong class="groupHeading" ng-bind-html="(group.$key|linkSource)||'Not Available'"></strong>
                <hr>
                <div class="row">
                    <div class="item" ng-repeat="quote in group">
                        <div class="well">
                            <div class="options">
                                <a class="trash" ng-if="!QuotesCtrl.topic.isDefault" confirm-click="Are you sure you want to delete this quote?" ng-click="QuotesCtrl.deleteQuote(quote)"><span class="glyphicon glyphicon-trash pull-right"></span></a>
                                <a class="edit" ng-if="!QuotesCtrl.topic.isDefault" ng-click='QuotesCtrl.openQuoteModal("lg", quote._id)'><i class="fa fa-pencil-square-o"></i></a>
                            </div>
                            <div class="row">
                                <span>&ldquo;</span><a ui-sref="quote({topicId:QuotesCtrl.topic._id,quoteId:quote._id})"> {{quote.text |trimFilter}}</a><span>&rdquo;</span> {{quote.author}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container" id="quotes" ng-if="!vm.groupBy">
        <div class="row">
            <span us-spinner="{radius:30, width:8, length: 16}" spinner-key="spinner-1"></span>
            <div class="item" bindonce ng-repeat="quote in QuotesCtrl.quotes | filter:vm.typeAhead">
                <div class="well">
                    <div class="options">
                        <a class="trash" ng-if="!QuotesCtrl.topic.isDefault" confirm-click="Are you sure you want to delete this quote?" ng-click="QuotesCtrl.deleteQuote(quote)"><span class="glyphicon glyphicon-trash pull-right"></span></a>
                        <a class="edit" ng-if="!QuotesCtrl.topic.isDefault" ng-click='QuotesCtrl.openQuoteModal("lg", quote._id)'><i class="fa fa-pencil-square-o"></i></a>
                    </div>
                    <div class="row">
                        <span>&ldquo;</span><a ui-sref="quote({topicId:QuotesCtrl.topic._id,quoteId:quote._id})"> {{quote.text |trimFilter}}</a><span>&rdquo;</span> {{quote.author}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<footer class="footer">
    <div class="container">
        <p>Wakeup App | 2015
        </p>
    </div>
</footer>
