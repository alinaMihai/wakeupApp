<div class="modal-header">
    <h3 class="modal-title">{{modalCtrl.data.heading}} Quote</h3>
</div>
<div class="modal-body">
    <form name="addQuoteForm">
        <div class="form-group" ng-class="{'has-error':addQuoteForm.author.$invalid && addQuoteForm.author.$dirty}">
            <label for="author">Author</label>
            <input autocomplete="off" maxlength="200" list="suggestions" type="text" name="author" ng-model="modalCtrl.data.author" class="form-control" required>
            <datalist id="suggestions">
                <select>
                    <option ng-repeat="suggestion in modalCtrl.data.authors" class="ng-scope">{{suggestion|trimFilter:50}}</option>
                </select>
            </datalist>
        </div>
        <div class="form-group" ng-class="{'has-error':addQuoteForm.theText.$invalid && addQuoteForm.theText.$dirty}">
            <label for="theText">Text</label>
            <textarea maxlength="1000" ng-model='modalCtrl.data.text' name="theText" class="form-control verticalTextArea" required></textarea>
        </div>
        <div class="form-group">
            <label for="source">Source</label>
            <input autocomplete="off" maxlength="200" list="sourceSuggestions" type="text" name="source" ng-model="modalCtrl.data.source" class="form-control">
            <datalist id="sourceSuggestions">
                <select>
                    <option ng-repeat="source in modalCtrl.data.sources" class="ng-scope">{{source|trimFilter:50}}</option>
                </select>
            </datalist>
        </div>
        <div class="form-group" ng-if="modalCtrl.data.heading==='Add'">
            <label for="comment">Comment</label>
            <textarea maxlength="500" ng-model='modalCtrl.data.comment' name="text" class="form-control verticalTextArea"></textarea>
        </div>
        <!--  <div class="form-group">
           <label for="questionSearch">Question</label>
           <div>
               <select ng-model="modalCtrl.data.associatedQuestion" class="form-control" >
                   <option value=""></option>
                   <option value="{{question.id}}" ng-selected="question.id==modalCtrl.data.question" ng-repeat="question in modalCtrl.data.allQuestions | orderBy:'topic'">`{{question.questionSet|trimFilter:50}}`~~{{question.text|trimFilter:50}}
                         </option>
               </select>
           </div>
       </div> -->
        <div class="form-group">
            Associate Questions
            <input type="text" class="form-control" placeholder="search questions" ng-model="modalCtrl.search">
            <div class="row searchQuestions">
                <div class="col-sm-4" bindonce ng-repeat="question in modalCtrl.data.allQuestions|orderBy:'questionSet'|filter:modalCtrl.search">
                    <div class="questionBox">
                        <p class="questionPrev">{{question.text|trimFilter:40}}</p>
                        <p class="questionSet">{{question.questionSet|trimFilter:50}}</p>
                        <div>
                            <button class="btn btn-success" ng-if="modalCtrl.data.questions.indexOf(question.id)===-1" ng-click="modalCtrl.data.questions.push(question.id)">Add</button>
                            <button class="btn btn-danger" ng-if="modalCtrl.data.questions.indexOf(question.id)!==-1" 
                            ng-click="modalCtrl.data.removeQuestion(question.id)">Remove</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <ul class="list-group">
            <li class="list-group-item" bindonce ng-repeat="question in modalCtrl.data.questions">
                {{modalCtrl.data.findQuestionText(question)|trimFilter:100}}
                <button class="btn btn-danger" ng-click="modalCtrl.data.removeQuestion(question)">Remove</button>
            </li>
        </ul>
    </form>
</div>
<div class="modal-footer">
    <button class="btn btn-primary btn-lg" type="button" ng-click="modalCtrl.ok()" ng-disabled="addQuoteForm.$invalid">{{modalCtrl.data.heading==='Edit'?'Update':'Save'}}</button>
    <button class="btn btn-warning btn-lg" type="button" ng-click="modalCtrl.cancel()">Cancel</button>
</div>
