<div ng-include="'components/navbar/navbar.html'"></div>
<div class="container">
    <session-dir ng-if="questionCtrl.questionSetQuestions.questions.length>0">
    </session-dir>
    <div class="row">
        <ol class="breadcrumb">
            <li><a ui-sref="questionSetList">Question Sets</a></li>
            <li class="active">{{questionCtrl.questionSetQuestions.name.length>=100?questionCtrl.questionSetQuestions.name.substring(0,50)+"...":questionCtrl.questionSetQuestions.name}}</li>
        </ol>
    </div>
    <div class="row">
        <div class="col-lg-9">
            <h1 class="questionSetName">{{questionCtrl.questionSetQuestions.name}}
      </h1>
        </div>
        <div class="col-lg-3" ng-if="!questionCtrl.questionSetQuestions.isDefault">
            <button id="addQuestionBtn" class="btn btn-info btn-block" ng-click="questionCtrl.addQuestionBool=true">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add Question
            </button>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-7">
            <div class="row">
                <div class="col-md-4 eiButtons">
                    <button class="btn btn-lg btn-block btn-success" type="button" ng-csv="questionCtrl.exportQuestions" filename="{{questionCtrl.questionSetQuestions.name}} questions.csv" ng-disabled="questionCtrl.exportQuestions.length===0">Export Questions</button>
                </div>
                <div class="col-md-4">
                    <button class="btn btn-lg btn-block btn-success" ng-click="questionCtrl.showImport=!questionCtrl.showImport" ng-if="!questionCtrl.questionSetQuestions.isDefault">Import CSV file</button>
                </div>
            </div>
        </div>
        <div class="col-xs-6" ng-if="questionCtrl.showImport">
            <ng-csv-import content="questionCtrl.csvContent" result="questionCtrl.csvResult" accept=".csv"></ng-csv-import>
        </div>
    </div>
    <hr>
    <div ng-if="!questionCtrl.questionSetQuestions.isDefault && questionCtrl.addQuestionBool">
        <form name="questionCtrl.addQuestion" novalidate>
            <div class="group-control" ng-class="{'has-error': questionCtrl.hasErrorAddForm()}">
                <label for="questionText">Question Text:
                    <textarea maxlength="200" id="addQuestionTextArea" name="questionText" type="text" cols="1000" rows="5" class="input input-lg form-control" required ng-model="questionCtrl.questionText"></textarea>
                </label>
                <button type="submit" class="btn btn-lg btn-success" ng-disabled="!questionCtrl.addQuestion.$valid" ng-click="questionCtrl.saveQuestion()">Save</button>
                <button class="btn btn-lg btn-danger" ng-click="questionCtrl.cancelAddQuestion()">Cancel</button>
            </div>
        </form>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <h4>Question Set Details</h4>
            <ul class="note">
                <li><strong ng-bind-html="questionCtrl.questionSetQuestions.description"></strong></li>
                <li><strong>Questions:</strong> <span ng-bind="questionCtrl.questionSetQuestions.questions.length"></span></li>
                <li ng-if="!questionCtrl.questionSetQuestions.isDefault"><strong>Impact:</strong><span ng-bind="questionCtrl.questionSetQuestions.impact"></span></li>
                <li ng-if="!questionCtrl.questionSetQuestions.isDefault"><strong>Creation at:</strong> <span ng-bind="questionCtrl.questionSetQuestions.createDate | date:'HH:mm a on dd-MM-yyyy'"></span></li>
                <li ng-if="!questionCtrl.questionSetQuestions.isDefault"><strong>Times Practiced:</strong> <span ng-bind="questionCtrl.questionSetQuestions.practiceTimes"></span></li>
            </ul>
        </div>
        <div class="col-lg-6">
            <a class="seeLastSessionBtn btn btn-lg btn-success" ui-sref="sessionDetails({'questionSetId':questionCtrl.questionSetQuestions._id,'questionSetName':questionCtrl.questionSetQuestions.name})">Question Set Details</a>
        </div>
    </div>
    <h4>Questions <span class="tooltipWrapper"><i class="fa fa-info-circle tooltipWrapper" uib-tooltip="Click on a question from the list to see all your answers"></i></span></h4>
    <div class="list-group" id="questionList">
        <span us-spinner="{radius:30, width:8, length: 16}" spinner-key="spinner-1" spinner-start-active="true"></span>
        <div class="list-group-item row" bindonce ng-repeat="q in questionCtrl.questionSetQuestions.questions">
            <div class="col-xs-12 col-sm-10 col-md-10 col-lg-11">
                <div class="row">
                    <div class="col-xs-2"><span class="numberItem">{{$index+1}}</span></div>
                    <div class="col-xs-10"><strong><a class="questionTextLink" ui-sref="answerList({questionId:q._id})"> {{q.text}}</a></strong></div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-2 col-md-2 col-lg-1 questionOptions" ng-if="!questionCtrl.questionSetQuestions.isDefault">
                <a title="delete question" confirm-click="Are you sure you want to delete this question?" ng-click="questionCtrl.deleteQuestion(q)" class="trash"><span class="glyphicon glyphicon-trash pull-right"></span></a>
                <a title="edit question" ng-click='questionCtrl.openEditQuestionModal("lg",q._id)'><i class="fa fa-pencil-square-o"></i></a>
            </div>
        </div>
    </div>
</div>
<footer class="footer">
    <div class="container">
        <p>Wakeup App | 2015 | <a href="https://twitter.com/AlinaMihai90">Twitter</a> | <a href="https://github.com/alinaMihai/wakeupApp/issues">Issues</a>
        </p>
    </div>
</footer>
